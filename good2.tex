\documentclass{article}
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{minted2}
\usepackage[margin=1in]{geometry}
\usepackage{courier}
\usepackage{fvextra} % Better minted inside tables
\usepackage{comment}
\usepackage{listings}
\usepackage{ltablex}
\keepXColumns

% Colors
\definecolor{addgreen}{RGB}{220,255,220}
\definecolor{remred}{RGB}{255,220,220}
\definecolor{diffchar}{RGB}{180,250,180} % inline change
\definecolor{lightgray}{gray}{0.95}


\lstdefinestyle{diffcode}{
    basicstyle=\fontencoding{T1}\selectfont\small\ttfamily,
    upquote=true,
    backgroundcolor=\color{lightgray},
    language=Python,
    showstringspaces=false,
    breaklines=true
}

\newcommand{\code}[1]{\lstinline[style=diffcode]!#1!}

% % Minted config
% \fvset{fontsize=\small, breaklines, breakanywhere=true, commandchars=\\\{\}}


\begin{document}

\begin{tabularx}{\linewidth}{r X r X}
\multicolumn{1}{c}{\textbf{\#}} & \multicolumn{1}{c}{\textbf{Old Code}} &
\multicolumn{1}{c}{\textbf{\#}} & \multicolumn{1}{c}{\textbf{New Code}} \\
\hline
\cellcolor{remred}1 & \cellcolor{remred}\code{\# Keywords \& syntax demo (A)} & \cellcolor{addgreen}1 & \cellcolor{addgreen}\code{\# Keywords \& syntax demo (B)} \\
2 & \code{} & 2 & \code{} \\
3 & \code{import math} & 3 & \code{import math} \\
4 & \code{from math import pi as circle\_pi} & 4 & \code{from math import pi as circle\_pi} \\
5 & \code{} & 5 & \code{} \\
6 & \code{class Example:} & 6 & \code{class Example:} \\
\cellcolor{remred}7 & \cellcolor{remred}\code{\ \ \ \ def \_\_init\_\_(self, value: int = 0) -> None:} & \cellcolor{addgreen}7 & \cellcolor{addgreen}\code{\ \ \ \ def \_\_init\_\_(self, value: int = 1) -> None:\ \ \# Changed default from 0 to 1} \\
8 & \code{\ \ \ \ \ \ \ \ self.value = value} & 8 & \code{\ \ \ \ \ \ \ \ self.value = value} \\
9 & \code{} & 9 & \code{} \\
10 & \code{\ \ \ \ def compute(self) -> float:} & 10 & \code{\ \ \ \ def compute(self) -> float:} \\
\cellcolor{remred}11 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ if self.value > 0:} & \cellcolor{addgreen}11 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ if self.value >= 0:\ \ \# Changed > to >=} \\
12 & \code{\ \ \ \ \ \ \ \ \ \ \ \ for i in range(1, 10):} & 12 & \code{\ \ \ \ \ \ \ \ \ \ \ \ for i in range(1, 10):} \\
\cellcolor{remred}13 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ while i < 5:} & \cellcolor{addgreen}13 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ while i < 6:\ \ \# Changed 5 to 6} \\
14 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ try:} & 14 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ try:} \\
\cellcolor{remred}15 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert i != 3, "Unlucky number"} & \cellcolor{addgreen}15 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert i != 4, "Unlucky number"\ \ \# Changed 3 to 4} \\
16 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yield i} & 16 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yield i} \\
17 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ break} & 17 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ break} \\
18 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ except AssertionError as e:} & 18 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ except AssertionError as e:} \\
\cellcolor{remred}19 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f"Caught: \{e\}")} & \cellcolor{addgreen}19 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f"Error: \{e\}")\ \ \# Changed message} \\
20 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ continue} & 20 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ continue} \\
21 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finally:} & 21 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finally:} \\
22 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pass} & 22 & \code{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pass} \\
\cellcolor{remred}23 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ elif self.value == 0:} & \cellcolor{addgreen}23 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ elif self.value == -1:\ \ \# Changed 0 to -1} \\
24 & \code{\ \ \ \ \ \ \ \ \ \ \ \ return None} & 24 & \code{\ \ \ \ \ \ \ \ \ \ \ \ return None} \\
25 & \code{\ \ \ \ \ \ \ \ else:} & 25 & \code{\ \ \ \ \ \ \ \ else:} \\
\cellcolor{remred}26 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ \ \ \ \ raise ValueError("Negative!")} & \cellcolor{addgreen}26 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ \ \ \ \ raise ValueError("Too negative!")\ \ \# Changed error message} \\
27 & \code{} & 27 & \code{} \\
28 & \code{def main():} & 28 & \code{def main():} \\
\cellcolor{remred}29 & \cellcolor{remred}\code{\ \ \ \ e = Example(2)} & \cellcolor{addgreen}29 & \cellcolor{addgreen}\code{\ \ \ \ if a:} \\
\cellcolor{remred}30 & \cellcolor{remred}\code{\ \ \ \ result = [x for x in e.compute() if x \% 2 == 0]} & \cellcolor{addgreen}30 & \cellcolor{addgreen}\code{} \\
\cellcolor{remred}31 & \cellcolor{remred}\code{\ \ \ \ print("Results:", result)} &  &  \\
\cellcolor{remred}32 & \cellcolor{remred}\code{} &  &  \\
33 & \code{\ \ \ \ match e.value:} & 31 & \code{\ \ \ \ match e.value:} \\
34 & \code{\ \ \ \ \ \ \ \ case 0:} & 32 & \code{\ \ \ \ \ \ \ \ case 0:} \\
35 & \code{\ \ \ \ \ \ \ \ \ \ \ \ print("Zero")} & 33 & \code{\ \ \ \ \ \ \ \ \ \ \ \ print("Zero")} \\
36 & \code{\ \ \ \ def inner(*args, **kwargs):} & 34 & \code{\ \ \ \ def inner(*args, **kwargs):} \\
37 & \code{\ \ \ \ \ \ \ \ global x} & 35 & \code{\ \ \ \ \ \ \ \ global x} \\
38 & \code{\ \ \ \ \ \ \ \ nonlocal result} & 36 & \code{\ \ \ \ \ \ \ \ nonlocal result} \\
\cellcolor{remred}39 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ x = lambda y: y ** 2} & \cellcolor{addgreen}37 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ x = lambda y: y + 1\ \ \# Changed expression} \\
\cellcolor{remred}40 & \cellcolor{remred}\code{\ \ \ \ \ \ \ \ print(\{k: v for k, v in kwargs.items()\})} & \cellcolor{addgreen}38 & \cellcolor{addgreen}\code{\ \ \ \ \ \ \ \ print(\{k: v.upper() for k, v in kwargs.items()\})\ \ \# Added .upper()} \\
41 & \code{\ \ \ \ \ \ \ \ return x(args[0]) if args else None} & 39 & \code{\ \ \ \ \ \ \ \ return x(args[0]) if args else None} \\
42 & \code{} & 40 & \code{} \\
\cellcolor{remred}43 & \cellcolor{remred}\code{\ \ \ \ print(inner(4, key='val'))} & \cellcolor{addgreen}41 & \cellcolor{addgreen}\code{\ \ \ \ print(inner(3, key='val'))\ \ \# Changed arg} \\
44 & \code{} & 42 & \code{} \\
45 & \code{if \_\_name\_\_ == "\_\_main\_\_":} & 43 & \code{if \_\_name\_\_ == "\_\_main\_\_":} \\
46 & \code{\ \ \ \ main()} & 44 & \code{\ \ \ \ main()} \\
\hline
\end{tabularx}

\end{document}
